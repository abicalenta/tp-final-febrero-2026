<div class="container">
  <button class="btn-back" (click)="volver()">
    ← Volver a Restaurantes
  </button>

  @if (isLoading()) {
    <div class="loading-state">
      <div class="spinner"></div>
      <p>Cargando el menú...</p>
    </div>
  } 
  @else {
    @if (user()) {
  <header class="restaurant-header">
    <h1>Bienvenido, {{ user()?.name }}</h1> 
    <p class="description">Bienvenido a nuestro menú digital</p>
  </header>
}

    <nav class="categories-nav">
      <button 
        [class.active]="selectedCategoryId() === null" 
        (click)="selectCategory(null)">
        Todos
      </button>
      
      @for (cat of categories(); track cat.id) {
        <button 
          [class.active]="selectedCategoryId() === cat.id"
          (click)="selectCategory(cat.id)">
          {{ cat.name }}
        </button>
      }
    </nav>

    <section class="products-grid">
      @for (prod of filteredProducts(); track prod.id) {
        <div class="product-card">
          <div class="product-info">
            <h3>{{ prod.name }}</h3>
            <p>{{ prod.description }}</p>
            <div class="price-container">
              @if (prod.discount) {
                <span class="old-price">${{ prod.price }}</span>
              }
              <span class="current-price">${{ calculateFinalPrice(prod) }}</span>
            </div>
          </div>
          @if (prod.discount) {
            <span class="discount-badge">-{{ prod.discount }}%</span>
          }
        </div>
      } @empty {
        <p class="empty-msg">No hay productos disponibles en esta categoría.</p>
      }
    </section>
  }
</div>
